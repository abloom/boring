#!/usr/bin/env ruby

$:.unshift File.expand_path File.join File.dirname(__FILE__), "..", "lib"

require 'slop'
require 'boring'
require 'boring/runner'

opts = Slop.parse(:help => true, :strict => true) do
  banner 'Usage: boring [options]'
  on :v, :video=, "video path"
  on :d, :dialogue=, "dialogue path"
end

raise "video path must be specified" unless opts.video?
raise "dialogue path must be specified" unless opts.dialogue?

dialogue_path = File.expand_path opts[:dialogue]
dialogues = Boring.find_dialogues dialogue_path

video_path = File.expand_path opts[:video]
videos = Boring.find_videos video_path

runner = Boring::Runner.new(videos, dialogues)

commands = [:video, :dialogue]

while true
  case commands.shuffle.first
  when :video
    runner.play_random_video
  when :dialogue
    runner.say_random_dialogue
  end

  sleep 5
end
